üßæ 1. Cotizaci√≥n / Solicitud de Cotizaci√≥n
‚úÖ OBJETIVO DEL MODELO
Reflejar este ciclo:
1.	Un usuario de la farmacia crea una solicitud de cotizaci√≥n (SC).
2.	Se env√≠a la SC a uno o m√°s proveedores.
3.	Cada proveedor puede responder con una cotizaci√≥n diferente:
o	con equivalencias (producto alternativo),
o	con cantidades m√≠nimas,
o	o no responder.
4.	La farmacia analiza, aprueba o descarta propuestas.
üß© FLUJO COMPLETO POSIBLE CON ESTAS TABLAS
Etapa	Tablas involucradas
Creaci√≥n de solicitud	SolicitudCotizacion, SolicitudCotizacionDetalle
Env√≠o a proveedores	SolicitudCotizacionProveedor
Respuesta de proveedor	CotizacionProveedor, CotizacionProveedorDetalle
Revisi√≥n y decisi√≥n interna	HistorialCotizacion, RechazoCotizacion (opcional)
Aprobaci√≥n para OC	(Se relaciona m√°s adelante con OrdenCompra)
 
‚úÖ VENTAJAS DEL MODELO
‚Ä¢	Soporta varios proveedores por solicitud.
‚Ä¢	Soporta respuestas parciales o incompletas.
‚Ä¢	Soporta producto alternativo o equivalente.
‚Ä¢	Trazabilidad completa: desde la solicitud hasta la decisi√≥n.
‚Ä¢	Permite reportes como:
o	Proveedores que m√°s cumplen con solicitudes.
o	Historial de precios ofrecidos.
o	Tiempo promedio de respuesta por proveedor.

Servicios backend para üßæ‚ÄØCotizaci√≥n /‚ÄØSolicitud de Cotizaci√≥n
Servicio (nombre en ingl√©s)	Responsabilidad principal	Entidades que gestiona
QuotationRequestService	‚Ä¢ Crear, editar y cerrar una SolicitudCotizacion.
‚Ä¢ Cambiar su estado (Abierta‚ÄØ‚Üí‚ÄØCerrada / Cancelada / Expirada).	SolicitudCotizacion
QuotationRequestItemService	‚Ä¢ A√±adir, actualizar o eliminar l√≠neas de producto solicitadas.
‚Ä¢ Validar cantidades positivas y existencia del producto.	SolicitudCotizacionDetalle
QuotationDispatchService	‚Ä¢ Registrar a qu√© proveedor(es) se env√≠a la solicitud.
‚Ä¢ Cambiar estado del env√≠o (Enviada‚ÄØ‚Üí‚ÄØRespondida / Expirada / Rechazada).
‚Ä¢ Disparar notificaciones externas (correo‚ÄØ/‚ÄØAPI).	SolicitudCotizacionProveedor
VendorQuotationService	‚Ä¢ Crear la cabecera de la respuesta del proveedor.
‚Ä¢ Gestionar vigencia (validez_dias) y condiciones de pago.
‚Ä¢ Aceptar o rechazar la propuesta.	CotizacionProveedor
VendorQuotationItemService	‚Ä¢ A√±adir l√≠neas ofertadas con precio, unidad alternativa o equivalencia.
‚Ä¢ Validar que la oferta cumpla cantidades m√≠nimas.	CotizacionProveedorDetalle
QuotationHistoryService	‚Ä¢ Registrar cambios relevantes (estados, ediciones, comentarios).
‚Ä¢ Consultar la bit√°cora completa por solicitud o cotizaci√≥n.	HistorialCotizacion
QuotationRejectionService	‚Ä¢ Motivar y registrar rechazos formales de cotizaciones.
‚Ä¢ Cambiar estado a Rechazada y notificar al proveedor.	RechazoCotizacion
QuotationEvaluationService	‚Ä¢ Consolidar todas las cotizaciones recibidas para una solicitud.
‚Ä¢ Calcular KPIs (costo total, tiempos, %‚ÄØde cumplimiento).
‚Ä¢ Seleccionar la oferta ‚Äúganadora‚Äù y preparar datos para la Orden de Compra.	Lectura de todas las tablas anteriores
QuotationReportService	‚Ä¢ Generar reportes de desempe√±o de proveedores y tiempos de respuesta.
‚Ä¢ Exportar a PDF/Excel o exponer endpoints para BI.	Vistas / consultas agregadas
QuotationNotificationService	‚Ä¢ Encapsular env√≠os de correo, alertas in app y webhooks a proveedores o usuarios internos en cada cambio de estado.	Integraci√≥n externa, no tabla propia
AttachmentService (opcional)	‚Ä¢ Subir y servir archivos adjuntos a solicitudes o cotizaciones.	Tabla de adjuntos si se requiere
Estos servicios cubren todo el ciclo:
creaci√≥n‚ÄØ‚Üí‚ÄØenv√≠o‚ÄØ‚Üí‚ÄØrespuesta‚ÄØ‚Üí‚ÄØan√°lisis‚ÄØ‚Üí‚ÄØcierre o rechazo, con trazabilidad completa y m√©tricas listas para alimentar la generaci√≥n de la Orden de Compra.









üìë 2. Orden de Compra

üîç ¬øQu√© incluye una Orden de Compra?
Una Orden de Compra (OC) es el documento formal con el que la farmacia se compromete a comprar productos a un proveedor, bajo condiciones previamente pactadas o definidas en la OC. Puede originarse:
‚Ä¢	A partir de una cotizaci√≥n aceptada (flujo ideal)
‚Ä¢	De manera directa (flujo inmediato sin cotizaci√≥n previa)
 
üß† Consideraciones incluidas en este modelo:
‚Ä¢	Casos exitosos (totalmente recibida y facturada)
‚Ä¢	Casos fallidos (cancelaci√≥n, anulaci√≥n, rechazo de productos)
‚Ä¢	Requerimientos reales:
o	Flujo de aprobaci√≥n
o	Recepci√≥n parcial
o	Varios √≠tems por OC
o	Condiciones comerciales (entrega, pago, impuestos)
o	Relaci√≥n con cotizaciones
o	Auditor√≠a
‚Ä¢	üìò FLUJOS CUBIERTOS
Caso	¬øCubierto por?
Orden directa (sin cotizaci√≥n)	origen = 'Directa'
Orden desde cotizaci√≥n	FK a CotizacionProveedor
Recepci√≥n parcial	RecepcionOrdenCompra
Cancelaci√≥n completa o parcial	CancelacionOrdenCompra
Condiciones especiales	CondicionComercialOrdenCompra
Trazabilidad y auditor√≠a	HistorialOrdenCompra, AprobacionOrdenCompra
Archivos asociados	DocumentoAdjuntoOrdenCompra


Servicios backend para üìë‚ÄØOrden de Compra (Purchase‚ÄØOrder)
Servicio (nombre en ingl√©s)	Responsabilidad principal	Entidades que gestiona / consulta
PurchaseOrderService	‚Ä¢ Crear la cabecera de la OC, directa o a partir de la cotizaci√≥n ganadora.
‚Ä¢ Editar datos generales (fechas, proveedor, notas).
‚Ä¢ Cambiar estado ‚Üí‚ÄØPendiente / Cancelada / Cerrada.	OrdenCompra
PurchaseOrderItemService	‚Ä¢ Agregar, actualizar o eliminar l√≠neas de producto.
‚Ä¢ Validar precios, IVA, cantidades y stock pendiente.
‚Ä¢ Calcular subtotal y totales.	OrdenCompraDetalle
CommercialTermsService	‚Ä¢ Registrar y editar condiciones especiales: forma‚ÄØde‚ÄØpago, lugar de entrega, descuentos globales, Incoterms.
‚Ä¢ Asociar texto legal o cl√°usulas.	CondicionComercialOrdenCompra
PurchaseApprovalService	‚Ä¢ Gestionar el flujo de aprobaci√≥n (uno o varios aprobadores).
‚Ä¢ Cambiar estado a Aprobada.
‚Ä¢ Registrar qui√©n, cu√°ndo y comentarios.	AprobacionOrdenCompra, campos de OrdenCompra
PurchaseOrderHistoryService	‚Ä¢ Auditar cada cambio de estado o edici√≥n.
‚Ä¢ Exponer consulta cronol√≥gica completa.	HistorialOrdenCompra
PurchaseOrderReceptionService	‚Ä¢ Registrar recepciones parciales / totales de cada √≠tem contra la OC.
‚Ä¢ Actualizar cantidades pendientes.
‚Ä¢ Detonar alertas cuando la suma recibida = cantidad ordenada.	RecepcionOrdenCompra
PurchaseOrderCancelService	‚Ä¢ Anular o cancelar total parcialmente una OC.
‚Ä¢ Revertir compromisos de stock y notificar a proveedores.	CancelacionOrdenCompra, OrdenCompra
PurchaseOrderAttachmentService	‚Ä¢ Subir, versionar y servir archivos (PDF‚ÄØOC firmada, contratos, correos).	DocumentoAdjuntoOrdenCompra
PurchaseOrderReportService	‚Ä¢ KPIs de cumplimiento (plazos, diferencias, precios).
‚Ä¢ Exportar listados de OCs abiertas, parciales o vencidas.	Vistas sobre OrdenCompra y detalles
PurchaseOrderNotificationService	‚Ä¢ Enviar correos / alertas internas al aprobar, cancelar o recepcionar una OC.
‚Ä¢ Opcional webhook al proveedor.	Integraci√≥n externa
PurchaseOrderIntegrationService (opcional)	‚Ä¢ Sincronizar OCs y recepciones con m√≥dulo contable / ERP externo.	API externa, no tabla propia
Con estos servicios cubres todo el ciclo operativo y de control: creaci√≥n, t√©rminos comerciales, aprobaci√≥n, recepci√≥n parcial o total, cancelaci√≥n, auditor√≠a, reporting y comunicaci√≥n con proveedores y usuarios internos.




üöö 3. Remisi√≥n de Proveedor

Muy bien, Gabriel. Vamos ahora con el modelado completo y robusto de la operaci√≥n üöö 3. Remisi√≥n de Proveedor, incluyendo:
‚Ä¢	Casos exitosos (remisi√≥n recibida y aprobada)
‚Ä¢	Casos con fallos (productos rechazados, remisi√≥n incompleta, remisi√≥n no autorizada)
‚Ä¢	Trazabilidad por lote, vencimiento, y orden de compra
‚Ä¢	Flujo normativo (INVIMA, DIAN - no fiscal pero trazable)
 
üîç ¬øQu√© es una remisi√≥n?
La remisi√≥n del proveedor es el documento que acompa√±a f√≠sicamente el despacho de los productos. Suele llegar antes que la factura y puede:
‚Ä¢	Ser parcial respecto a la orden de compra
‚Ä¢	Incluir productos con errores, vencimientos, cambios de lote
‚Ä¢	Ser rechazada total o parcialmente
En sistemas bien implementados, la remisi√≥n no ingresa al inventario, pero activa el proceso de recepci√≥n, donde se valida lo recibido.
üìò FLUJOS CUBIERTOS
Flujo / Escenario	¬øQu√© tabla lo cubre?
Remisi√≥n total o parcial	RemisionProveedor, RemisionDetalle
Lote y vencimiento entregado	RemisionDetalle
Producto no coincide con OC	DiscrepanciaRemision
Producto rechazado	RechazoRemisionDetalle
Auditor√≠a de cambios	HistorialRemisionProveedor
Archivos recibidos	DocumentoAdjuntoRemision
Productos equivalentes entregados	RemisionProductoEquivalente



Servicios backend para üöö‚ÄØRemisi√≥n‚ÄØde‚ÄØProveedor (Supplier Shipment)
Servicio (nombre en ingl√©s)	Responsabilidad principal	Entidades que gestiona /‚ÄØconsulta
SupplierShipmentService	‚Ä¢ Registrar la cabecera de la remisi√≥n que entrega el proveedor.
‚Ä¢ Cambiar estado (Pendiente‚ÄØ‚Üí‚ÄØRecibida / Parcial / Rechazada / Anulada).
‚Ä¢ Vincularla a la Orden‚ÄØde‚ÄØCompra correspondiente.	RemisionProveedor
SupplierShipmentItemService	‚Ä¢ A√±adir y editar l√≠neas remitidas con cantidad, lote y vencimiento.
‚Ä¢ Validar que los √≠tems existan en la OC y que los lotes no est√©n vencidos.
‚Ä¢ Calcular totales remitidos.	RemisionDetalle
ShipmentDiscrepancyService	‚Ä¢ Registrar discrepancias (faltantes, sobrantes, producto inesperado, lote diferente, vencido).
‚Ä¢ Clasificar severidad y marcar si requiere acci√≥n correctiva.	DiscrepanciaRemision
ShipmentRejectionService	‚Ä¢ Registrar rechazos totales o parciales de los productos de la remisi√≥n.
‚Ä¢ Actualizar cantidades rechazadas y estado general (Rechazada).
‚Ä¢ Notificar al proveedor.	RechazoRemisionDetalle, RemisionProveedor
ShipmentEquivalentItemService	‚Ä¢ Manejar productos equivalentes entregados (c√≥digos alternativos).
‚Ä¢ Guardar justificaci√≥n y asociar original vs. entregado.	RemisionProductoEquivalente
ShipmentHistoryService	‚Ä¢ Auditar todas las acciones sobre la remisi√≥n (creaci√≥n, edici√≥n, cambio de estado).
‚Ä¢ Exponer consulta detallada para trazabilidad INVIMA/DIAN.	HistorialRemisionProveedor
ShipmentAttachmentService	‚Ä¢ Gestionar subida y consulta de PDFs, gu√≠as de transporte, evidencias fotogr√°ficas.
‚Ä¢ Versionar y asegurar URLs.	DocumentoAdjuntoRemision
ShipmentValidationService	‚Ä¢ Validar reglas de negocio antes de pasar a recepci√≥n (ej.: lote obligatorio, fecha‚ÄØ‚â•‚ÄØhoy, cantidades coherentes).
‚Ä¢ Bloquear flujo si hay discrepancias cr√≠ticas.	Lectura de RemisionDetalle & discrepancias
ShipmentNotificationService	‚Ä¢ Enviar alertas a log√≠stica almac√©n, compras y proveedor al registrar, aceptar o rechazar remisi√≥n.
‚Ä¢ Recordatorios autom√°ticos si la remisi√≥n queda ‚ÄúPendiente‚Äù demasiado tiempo.	Integraci√≥n externa
ShipmentReportingService	‚Ä¢ M√©tricas de cumplimiento: exactitud de env√≠o, frecuencia de discrepancias, √≠ndice de rechazo.
‚Ä¢ Exportar reportes a BI / Excel.	Vistas sobre todas las tablas de remisi√≥n
ShipmentIntegrationService (opcional)	‚Ä¢ Publicar eventos a m√≥dulos de Recepci√≥n y Calidad.
‚Ä¢ Sincronizar con sistemas WMS o TMS externos si aplica.	Eventos / webhooks
Con esta capa de servicios se cubre la gesti√≥n completa de la remisi√≥n: registro, validaci√≥n contra la OC, manejo de discrepancias y rechazos, auditor√≠a exhaustiva, anexos y reporting, antes de dar paso al m√≥dulo de Recepci√≥n de Mercanc√≠a.





üì• 4. Recepci√≥n de Mercanc√≠a

üîç ¬øQu√© es la recepci√≥n de mercanc√≠a?
La recepci√≥n de mercanc√≠a es la operaci√≥n mediante la cual la farmacia verifica f√≠sicamente lo que lleg√≥ (desde la remisi√≥n del proveedor) y decide qu√© se acepta o rechaza antes de ingresarlo al inventario.
Es el punto de control de calidad y cumplimiento, con impacto directo en:
‚Ä¢	Trazabilidad de lotes
‚Ä¢	Seguridad sanitaria
‚Ä¢	Inventario
‚Ä¢	Pagos y facturaci√≥n
 
‚úÖ FLUJOS Y ESCENARIOS CONSIDERADOS
1.	Recepci√≥n total (todo lo remitido es aceptado)
2.	Recepci√≥n parcial (faltan √≠tems o se rechazan productos)
3.	Recepci√≥n rechazada (todo se rechaza por error, da√±o, vencimiento)
4.	M√∫ltiples recepciones para una misma remisi√≥n
5.	Revisi√≥n por criterios de calidad: empaque, temperatura, fecha de vencimiento
6.	Seguimiento de causas de rechazo
7.	Aprobaci√≥n formal para ingreso a inventario

üìò FLUJOS CUBIERTOS
Escenario	¬øQu√© tabla lo cubre?
Recepci√≥n desde remisi√≥n	RecepcionCompra
Lotes y vencimiento validados	RecepcionDetalle
Rechazo parcial o total	RechazoRecepcionDetalle
Control de calidad	ChecklistRecepcion
Auditor√≠a interna	HistorialRecepcionCompra
Evidencias documentales	DocumentoAdjuntoRecepcion
 
‚úÖ VENTAJAS DE ESTE MODELO
‚Ä¢	Permite validaci√≥n manual y automatizada de entregas
‚Ä¢	Registra problemas de calidad o incumplimiento
‚Ä¢	Separa recepci√≥n de ingreso a inventario, como debe ser
‚Ä¢	Trazabilidad completa desde orden hasta ingreso f√≠sico
‚Ä¢	Permite trazabilidad normativa exigida por INVIMA (control de lotes, vencimiento, rechazo)

Servicios backend para üì•‚ÄØRecepci√≥n‚ÄØde‚ÄØMercanc√≠a (Goods‚ÄØReceipt)
Servicio (nombre en ingl√©s)	Responsabilidad principal	Entidades que gestiona‚ÄØ/‚ÄØconsulta
GoodsReceiptService	‚Ä¢ Crear la cabecera de la recepci√≥n a partir de la remisi√≥n.
‚Ä¢ Cambiar estado (EnRevision‚ÄØ‚Üí‚ÄØParcial / Aprobada / Rechazada).
‚Ä¢ Verificar que la remisi√≥n exista y no est√© anulada.	RecepcionCompra
GoodsReceiptItemService	‚Ä¢ A√±adir y editar l√≠neas recibidas: cantidad, lote, vencimiento.
‚Ä¢ Validar que la suma aceptada + rechazada ‚â§ cantidad remitida.
‚Ä¢ Calcular totales aceptados / rechazados.	RecepcionDetalle
QualityChecklistService	‚Ä¢ Registrar criterios de inspecci√≥n (temperatura, empaque, lote legible, etc.).
‚Ä¢ Marcar cumplimiento y comentarios.	ChecklistRecepcion
ReceiptRejectionService	‚Ä¢ Detallar causas y cantidades cuando se rechaza un producto.
‚Ä¢ Actualizar stock pendiente de la remisi√≥n.
‚Ä¢ Cambiar estado_item y, si corresponde, estado global a Rechazada.	RechazoRecepcionDetalle, RecepcionDetalle, RecepcionCompra
ReceiptApprovalService	‚Ä¢ Aprobar formalmente la recepci√≥n aceptada.
‚Ä¢ Disparar evento al m√≥dulo de Ingreso‚ÄØa‚ÄØInventario.
‚Ä¢ Registrar usuario y fecha de aprobaci√≥n.	Campos de RecepcionCompra
ReceiptHistoryService	‚Ä¢ Auditar cada acci√≥n: creaci√≥n, ediciones, checklist, rechazos, aprobaci√≥n.
‚Ä¢ Consultar bit√°cora completa para INVIMA / auditor√≠as internas.	HistorialRecepcionCompra
ReceiptAttachmentService	‚Ä¢ Subir y servir evidencias: fotos de empaque, gu√≠as firmadas, lecturas de temperatura.
‚Ä¢ Versionar y mantener metadatos.	DocumentoAdjuntoRecepcion
ReceiptValidationService	‚Ä¢ Reglas autom√°ticas: fecha‚ÄØde‚ÄØvencimiento ‚â•‚ÄØhoy, lotes obligatorios, control de productos restringidos.
‚Ä¢ Bloquear aprobaci√≥n si no se cumple.	Lectura de RecepcionDetalle + checklist
ReceiptNotificationService	‚Ä¢ Avisar a compras y contabilidad cuando hay rechazos o recepci√≥n aprobada.
‚Ä¢ Notificar al proveedor si hubo rechazo.	Integraci√≥n externa
ReceiptReportingService	‚Ä¢ KPIs: %‚ÄØde productos rechazados, causas frecuentes, tiempo de inspecci√≥n.
‚Ä¢ Exportar dashboards / informes.	Vistas sobre todas las tablas de recepci√≥n
ReceiptIntegrationService	‚Ä¢ Publicar evento ‚Äúreceipt approved‚Äù al m√≥dulo de Inventario (crea IngresoInventario).
‚Ä¢ Opcional: sincronizar con WMS externo.	Eventos / colas
Estos servicios permiten gestionar, validar y auditar todo el flujo de Recepci√≥n de Mercanc√≠a, asegurando trazabilidad de lotes, cumplimiento sanitario y sincronizaci√≥n posterior con el inventario y la contabilidad.






üßæ 5. Factura del Proveedor

üîç ¬øQu√© es la factura del proveedor?
Es el documento fiscal legal emitido por el proveedor (obligatoriamente electr√≥nico en Colombia desde 2020), que respalda jur√≠dicamente la transacci√≥n. Puede incluir productos entregados:
‚Ä¢	Parcial o totalmente
‚Ä¢	Relacionados con una o varias remisiones y √≥rdenes
‚Ä¢	Con o sin retenciones aplicables
 
‚úÖ FLUJOS Y ESCENARIOS CUBIERTOS
‚Ä¢	Factura aceptada y conciliada con remisi√≥n y recepci√≥n
‚Ä¢	Factura rechazada por diferencias
‚Ä¢	Factura parcialmente registrada (por diferencia en √≠tems)
‚Ä¢	Factura anulada
‚Ä¢	Factura con retenciones en la fuente e IVA
‚Ä¢	Factura electr√≥nica (adjunto XML obligatorio)
‚Ä¢	Factura agrupando varias remisiones u √≥rdenes

üìò FLUJOS CUBIERTOS
Escenario	¬øQu√© tabla lo cubre?
Factura simple y directa	FacturaCompra, FacturaCompraDetalle
Factura con m√∫ltiples remisiones	RelacionFacturaRemision
Rechazo por diferencias o errores	RechazoFacturaCompra
Auditor√≠a	HistorialFacturaCompra
Factura electr√≥nica	DocumentoAdjuntoFacturaCompra
Retenciones aplicables	RetencionFacturaCompra
 
‚úÖ BENEFICIOS DE ESTE MODELO
‚Ä¢	Total trazabilidad con √≥rdenes y remisiones
‚Ä¢	Soporte normativo para facturaci√≥n electr√≥nica y contabilidad
‚Ä¢	Posibilidad de conciliaci√≥n automatizada
‚Ä¢	Control de impuestos y obligaciones tributarias
‚Ä¢	Permite reportes financieros confiables y auditables

Servicios backend para üßæ‚ÄØFactura‚ÄØdel‚ÄØProveedor (Supplier‚ÄØInvoice)
Servicio (nombre en ingl√©s)	Responsabilidad principal	Entidades que gestiona‚ÄØ/‚ÄØconsulta
SupplierInvoiceService	‚Ä¢ Registrar cabecera de factura (manual o auto importaci√≥n XML).
‚Ä¢ Cambiar estado (Pendiente‚ÄØ‚Üí‚ÄØAprobada / Conciliada / Rechazada / Anulada).
‚Ä¢ Validar regla financiera (total = subtotal ‚àí descuentos + IVA).	FacturaCompra
SupplierInvoiceItemService	‚Ä¢ A√±adir, editar o eliminar l√≠neas facturadas.
‚Ä¢ Verificar cantidades, precios unitarios y %‚ÄØIVA.
‚Ä¢ Calcular totales por √≠tem.	FacturaCompraDetalle
InvoiceRemittanceLinkService	‚Ä¢ Relacionar factura con una o varias remisiones y √≥rdenes.
‚Ä¢ Verificar coherencia de cantidades y lotes.
‚Ä¢ Mostrar diferencias para conciliaci√≥n.	RelacionFacturaRemision
InvoiceRetentionService	‚Ä¢ Registrar y calcular retenciones: IVA, Renta, ICA, autoretecci√≥n.
‚Ä¢ Ajustar valor neto a pagar.	RetencionFacturaCompra
InvoiceReconciliationService	‚Ä¢ Conciliar factura con recepciones aprobadas.
‚Ä¢ Detectar sobrantes, faltantes o precios distintos.
‚Ä¢ Marcar factura parcial o rechazar.	Lectura de factura, remisi√≥n y recepci√≥n
InvoiceRejectionService	‚Ä¢ Registrar motivo y usuario cuando la factura se rechaza.
‚Ä¢ Cambiar estado a Rechazada y notificar proveedor.	RechazoFacturaCompra, FacturaCompra
InvoiceAttachmentService	‚Ä¢ Guardar XML oficial, PDF representativo y otros soportes.
‚Ä¢ Mantener metadatos y versi√≥n.	DocumentoAdjuntoFacturaCompra
InvoiceHistoryService	‚Ä¢ Auditar cada cambio de estado o edici√≥n de la factura.
‚Ä¢ Exponer trazabilidad completa para DIAN y auditor√≠as internas.	HistorialFacturaCompra
InvoiceNotificationService	‚Ä¢ Enviar alertas a contabilidad/compras ante: factura recibida, conciliada o rechazada.
‚Ä¢ Opcional notificar proveedor con resultado de validaci√≥n.	Integraci√≥n externa
InvoiceReportingService	‚Ä¢ KPIs financieros: facturas pendientes, rechazadas, tiempos de conciliaci√≥n, retenciones generadas.
‚Ä¢ Exportar a BI, PDF o Excel.	Vistas sobre facturas y retenciones
InvoiceIntegrationService	‚Ä¢ Publicar asientos contables a m√≥dulo Financiero / ERP.
‚Ä¢ Sincronizar con tesorer√≠a para flujo de pagos.	API externa, eventos
InvoiceValidationService (opcional)	‚Ä¢ Validar estructura y firma del XML de factura electr√≥nica.
‚Ä¢ Verificar CUFE y numeraci√≥n DIAN.	Lectura de XML, no tabla propia
Con estos servicios manejas todo el ciclo de la Factura‚ÄØdel‚ÄØProveedor: registro (manual o electr√≥nico), verificaci√≥n normativa, conciliaci√≥n con remisiones y OCs, gesti√≥n de retenciones, auditor√≠a exhaustiva y conexi√≥n con los m√≥dulos contable y de pagos.




üì¶ 6. Ingreso a Inventario

üîç ¬øQu√© implica el ingreso a inventario?
El Ingreso a Inventario es la operaci√≥n que registra oficialmente los productos aceptados en el sistema y que estar√°n disponibles para ventas o uso. Debe derivarse de una recepci√≥n aprobada, pero pueden haber otras fuentes como:
‚Ä¢	Ajustes por sobrantes
‚Ä¢	Donaciones
‚Ä¢	Ingresos por devoluciones
 
‚úÖ FLUJOS Y CASOS CUBIERTOS
1.	Ingreso por recepci√≥n validada (flujo ideal)
2.	Ingreso parcial o por lote espec√≠fico
3.	Ingreso con error (rollback)
4.	Ingreso por ajuste manual
5.	Ingreso con costo distinto al esperado
6.	Ingreso cancelado o anulado
7.	Control de productos vencidos o controlados
8.	Registro de trazabilidad contable (opcional, como puente a m√≥dulo contable)

‚úÖ BENEFICIOS DEL MODELO
‚Ä¢	Estructura profesional, alineada con trazabilidad INVIMA y log√≠stica moderna
‚Ä¢	M√∫ltiples fuentes de ingreso (recepci√≥n, ajuste, etc.)
‚Ä¢	Control por lote y vencimiento desde el ingreso
‚Ä¢	Permite historial para auditor√≠as, reversi√≥n y control contable
‚Ä¢	Evita ingreso directo al inventario sin verificaci√≥n previa


Servicios backend para üì¶‚ÄØIngreso‚ÄØa‚ÄØInventario (Inventory‚ÄØInbound)
Servicio (nombre en ingl√©s)	Responsabilidad principal	Entidades que gestiona‚ÄØ/‚ÄØconsulta
InventoryInboundService	‚Ä¢ Crear el cabecera de ingreso a partir de una recepci√≥n aprobada o de un ajuste/devoluci√≥n.
‚Ä¢ Cambiar estado (Pendiente‚ÄØ‚Üí‚ÄØConfirmado / Anulado).
‚Ä¢ Asignar correlativo y fuente (Recepcion, Ajuste, Devolucion, Manual).	IngresoInventario
InventoryInboundItemService	‚Ä¢ A√±adir, editar o eliminar l√≠neas ingresadas.
‚Ä¢ Validar lote, fecha de vencimiento y cantidad‚ÄØ>‚ÄØ0.
‚Ä¢ Calcular costo promedio o FIFO seg√∫n pol√≠tica.	IngresoInventarioDetalle
StockMovementService	‚Ä¢ Generar movimientos contables/l√≥gicos de stock al confirmar ingreso.
‚Ä¢ Registrar tipo (Entrada, Ajuste, Anulacion).
‚Ä¢ Sincronizar con LoteProductoSucursal (crear lote o actualizar cantidad).	MovimientoInventario, LoteProductoSucursal
InboundValidationService	‚Ä¢ Reglas autom√°ticas: fecha‚ÄØde‚ÄØvencimiento ‚â•‚ÄØhoy, lote obligatorio, control de medicamentos controlados.
‚Ä¢ Bloquear confirmaci√≥n si no se cumple.	Lectura de detalles y lotes
InboundCancellationService	‚Ä¢ Anular un ingreso confirmado (rollback).
‚Ä¢ Registrar motivo, usuario y fecha.
‚Ä¢ Revertir movimientos de stock.	AnulacionIngresoInventario, IngresoInventario, MovimientoInventario
InboundHistoryService	‚Ä¢ Auditar cada acci√≥n (creaci√≥n, confirmaci√≥n, anulaci√≥n).
‚Ä¢ Consultar bit√°cora completa para INVIMA y revisiones contables.	HistorialIngresoInventario
InboundAttachmentService	‚Ä¢ Subir y servir certificados de calidad, actas de donaci√≥n, fotos de lotes.
‚Ä¢ Versionar y mantener metadatos.	DocumentoAdjuntoIngresoInventario
InboundNotificationService	‚Ä¢ Notificar a compras, contabilidad y planeaci√≥n de stock cuando se confirma o anula un ingreso.
‚Ä¢ Alertar si se detectan productos vencidos o controlados.	Integraci√≥n externa
InboundReportingService	‚Ä¢ KPIs: tiempo entre recepci√≥n y disponibilidad, valor de inventario ingresado, ajustes realizados.
‚Ä¢ Exportar informes a BI / Excel.	Vistas sobre IngresoInventario, stock y movimientos
InboundIntegrationService	‚Ä¢ Publicar eventos a m√≥dulos de Contabilidad (costos) y Ventas (disponibilidad).
‚Ä¢ Sincronizar con WMS o ERP externo si aplica.	Eventos / colas, API externa
InboundAdjustmentService (opcional)	‚Ä¢ Crear ingresos tipo ‚ÄúAjuste‚Äù para sobrantes o correcciones.
‚Ä¢ Validar autorizaci√≥n y registrar usuario responsable.	IngresoInventario, MovimientoInventario
Estos servicios cubren todo el ciclo del Ingreso‚ÄØa‚ÄØInventario: creaci√≥n desde recepciones o ajustes, validaci√≥n normativa y de calidad, confirmaci√≥n con impacto en stock, anulaci√≥n con rollback, auditor√≠a y reporting, garantizando trazabilidad completa y conexi√≥n con contabilidad y log√≠stica.

